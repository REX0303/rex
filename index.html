<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dino Tycoon</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom right, #fceabb, #f8b500);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #333;
    }

    h1 {
      margin-top: 20px;
    }

    #stats {
      text-align: center;
      margin: 10px 0;
    }

    #stats div {
      margin: 5px;
      font-size: 1.2em;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background: #2980b9;
      color: white;
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    #dino-list {
      max-width: 500px;
      width: 90%;
      margin: 20px auto;
      list-style: none;
      padding: 0;
    }

    .dino-item {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 10px;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .equipped {
      background-color: #d1f7d1;
    }

    .dino-info {
      flex: 1 1 60%;
    }

    .dino-buttons {
      flex: 1 1 35%;
      text-align: right;
    }

    #boost-timer {
      margin-top: 10px;
      font-weight: bold;
    }

    @media screen and (max-width: 600px) {
      button {
        width: 90%;
        font-size: 18px;
      }

      .dino-buttons {
        text-align: left;
        margin-top: 10px;
      }
    }
  </style>
</head>
<body>

  <h1>ü¶ñ Dino Tycoon</h1>

  <div id="stats">
    <div id="dnc">üí∞ DNC Tokens: 0</div>
    <div id="meteorites">‚òÑÔ∏è Meteoritos: 0</div>
    <div id="production">Producci√≥n: 0 DNC/seg</div>
    <div id="boost-timer"></div>
  </div>

  <button onclick="openChest()">üéÅ Abrir Cofre (Costo: <span id='chest-cost'>10</span> DNC)</button>
  <button onclick="activateBoost()">‚ö° Usar Boost (3 meteoritos)</button>
  <button onclick="resetGame()">üîÑ Reiniciar Juego</button>

  <ul id="dino-list"></ul>

  <script>
    // Variables del juego
    let dnc = 0;
    let chestCost = 10;
    let meteorites = 0;
    const baseProduction = 1;
    const equippedLimit = 3;
    let ownedDinos = [];
    let boostActive = false;
    let boostEndTime = 0;
    let boostTimerInterval = null;

    // Datos de dinosaurios por nivel
    const dinosaurs = [
      { name: "Velociraptor", level: 1, baseBoost: 1 },
      { name: "Anquilosaurio", level: 2, baseBoost: 3 },
      { name: "Triceratops", level: 3, baseBoost: 7 },
      { name: "Rex", level: 4, baseBoost: 20 }
    ];

    const chestProbabilities = [
      { level: 1, chance: 0.90 },
      { level: 2, chance: 0.08 },
      { level: 3, chance: 0.015 },
      { level: 4, chance: 0.005 }
    ];

    function getRandomDinoLevel() {
      const r = Math.random();
      let acc = 0;
      for (let i = 0; i < chestProbabilities.length; i++) {
        acc += chestProbabilities[i].chance;
        if (r <= acc) return chestProbabilities[i].level;
      }
      return 1;
    }

    function openChest() {
      if (dnc >= chestCost) {
        dnc -= chestCost;
        chestCost = Math.floor(chestCost * 1.75);

        const level = getRandomDinoLevel();
        const template = dinosaurs.find(d => d.level === level);
        if (!template) return;

        const newDino = { ...template, equipped: false };
        ownedDinos.push(newDino);

        updateDisplay();
        renderDinoList();
        saveGame();
      } else {
        alert("No tienes suficiente DNC.");
      }
    }

    function toggleEquip(index) {
      const dino = ownedDinos[index];
      const equippedCount = ownedDinos.filter(d => d.equipped).length;
      if (dino.equipped) {
        dino.equipped = false;
      } else {
        if (equippedCount < equippedLimit) {
          dino.equipped = true;
        } else {
          alert("Solo puedes equipar 3 dinosaurios.");
        }
      }
      updateDisplay();
      renderDinoList();
      saveGame();
    }

    function getTotalProduction() {
      const dinoProduction = ownedDinos
        .filter(d => d.equipped)
        .reduce((sum, d) => sum + (typeof d.baseBoost === 'number' ? d.baseBoost : 0), 0);
      let total = baseProduction + dinoProduction;
      if (boostActive) total *= 2;
      return Math.round(total * 10) / 10;
    }

    function activateBoost() {
      if (meteorites < 3) return alert("No tienes suficientes meteoritos.");
      if (boostActive) return alert("El boost ya est√° activo.");

      meteorites -= 3;
      boostActive = true;
      boostEndTime = Date.now() + 5 * 60 * 1000;

      if (boostTimerInterval) clearInterval(boostTimerInterval);
      boostTimerInterval = setInterval(updateBoostTimer, 1000);

      updateBoostTimer();
      updateDisplay();
      saveGame();
    }

    function updateBoostTimer() {
      const remaining = boostEndTime - Date.now();
      if (remaining <= 0) {
        boostActive = false;
        document.getElementById("boost-timer").innerText = "";
        clearInterval(boostTimerInterval);
        boostTimerInterval = null;
        updateDisplay();
        saveGame();
      } else {
        const min = Math.floor(remaining / 60000);
        const sec = Math.floor((remaining % 60000) / 1000);
        document.getElementById("boost-timer").innerText = `‚ö° Boost activo por ${min}:${sec.toString().padStart(2, "0")}`;
      }
    }

    function combineDinos(level) {
      const required = level === 1 ? 2 : level === 2 ? 3 : 10;
      const candidates = ownedDinos.filter(d => d.level === level);
      if (candidates.length < required) return;

      // Eliminar dinos usados
      let removed = 0;
      for (let i = ownedDinos.length - 1; i >= 0 && removed < required; i--) {
        if (ownedDinos[i].level === level) {
          ownedDinos.splice(i, 1);
          removed++;
        }
      }

      const next = dinosaurs.find(d => d.level === level + 1);
      if (next) ownedDinos.push({ ...next, equipped: false });

      alert(`¬°Combinaste ${required} dinosaurios nivel ${level} y obtuviste uno nivel ${level + 1}!`);
      updateDisplay();
      renderDinoList();
      saveGame();
    }

    function renderDinoList() {
      const list = document.getElementById("dino-list");
      list.innerHTML = "";

      const levelCount = {};
      for (let d of ownedDinos) {
        levelCount[d.level] = (levelCount[d.level] || 0) + 1;
      }

      ownedDinos.forEach((d, i) => {
        const item = document.createElement("li");
        item.className = "dino-item" + (d.equipped ? " equipped" : "");

        item.innerHTML = `
          <div class="dino-info">
            ü¶ï ${d.name} (Nivel ${d.level})<br>
            +${d.baseBoost} DNC/s<br>
            Estado: <strong>${d.equipped ? "Equipado" : "Reposo"}</strong>
          <div class="dino-buttons">
  <button onclick="toggleEquip(${i})">
    ${d.equipped ? "Retirar" : "Equipar"}
  </button><br>
  <button onclick="sellDino(${i})" style="margin-top:5px; background:#e67e22; color:white;">
    Vender ü™ô
  </button>
</div>

        `;
        list.appendChild(item);
      });

      // Botones para combinar
      for (let lvl = 1; lvl <= 3; lvl++) {
        const required = lvl === 1 ? 2 : lvl === 2 ? 3 : 10;
        if ((levelCount[lvl] || 0) >= required) {
          const btn = document.createElement("button");
          btn.innerText = `üîÅ Combinar ${required} nivel ${lvl}`;
          btn.onclick = () => combineDinos(lvl);
          list.appendChild(btn);
        }
      }
    }

    function updateDisplay() {
      document.getElementById("dnc").innerText = `üí∞ DNC Tokens: ${Math.floor(dnc)}`;
      document.getElementById("meteorites").innerText = `‚òÑÔ∏è Meteoritos: ${meteorites}`;
      document.getElementById("chest-cost").innerText = chestCost;
      document.getElementById("production").innerText = `Producci√≥n: ${getTotalProduction()} DNC/seg`;
    }

    function saveGame() {
      const game = {
        dnc,
        chestCost,
        meteorites,
        ownedDinos,
        boostActive,
        boostEndTime
      };
      localStorage.setItem("dinoTycoonSave", JSON.stringify(game));
    }

    function loadGame() {
      const saved = localStorage.getItem("dinoTycoonSave");
      if (!saved) return;
      const game = JSON.parse(saved);
      dnc = game.dnc || 0;
      chestCost = game.chestCost || 10;
      meteorites = game.meteorites || 0;
      ownedDinos = game.ownedDinos || [];
      boostActive = game.boostActive || false;
      boostEndTime = game.boostEndTime || 0;

      if (boostActive && boostEndTime > Date.now()) {
        boostTimerInterval = setInterval(updateBoostTimer, 1000);
        updateBoostTimer();
      } else {
        boostActive = false;
      }
    }

   function resetGame() {
  if (confirm("¬øSeguro que deseas reiniciar el juego?")) {
    // Detener temporizadores si est√°n activos
    if (boostTimerInterval) {
      clearInterval(boostTimerInterval);
      boostTimerInterval = null;
    }

    // Eliminar datos guardados
    localStorage.removeItem("dinoTycoonSave");

    // Reiniciar variables
    dnc = 0;
    chestCost = 10;
    meteorites = 0;
    ownedDinos = [];
    boostActive = false;
    boostEndTime = 0;

    // Actualizar todo
    renderDinoList();
    updateDisplay();
    document.getElementById("boost-timer").innerText = "";
    saveGame();

    alert("¬°Juego reiniciado con √©xito!");
  }
}

    // Loop de producci√≥n
    setInterval(() => {
      dnc += getTotalProduction();
      updateDisplay();
      saveGame();
    }, 1000);

    // Inicializaci√≥n
    loadGame();
    updateDisplay();
    renderDinoList();
    
    function sellDino(index) {
  const dino = ownedDinos[index];
  if (!confirm(`¬øQuieres vender a ${dino.name} (Nivel ${dino.level}) por 5 meteoritos?`)) return;

  ownedDinos.splice(index, 1);
  meteorites += 5;

  updateDisplay();
  renderDinoList();
  saveGame();
}

  </script>
</body>
</html>
